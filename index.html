<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homepage with SVG Background and Scrollama</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow-x: hidden;
            font-family: Arial, sans-serif;
        }
        #map-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://raw.githubusercontent.com/michaelsalama1/gah/508899a752ceb2c9987ba444de30a69eafc8da55/nyc.svg') no-repeat center center;
            background-size: cover;
            transition: transform 0.5s ease;
        }
        .content {
            position: relative;
            z-index: 1;
            color: white;
            padding-top: 100vh; /* Initial space to start scrolling */
            padding-left: 20px; /* Space from left edge */
        }
        .header {
            font-size: 2.5em;
            margin: 20px 0;
            text-align: left;
        }
        .subheader {
            font-size: 1.5em;
            margin: 20px 0;
            text-align: left;
        }
        .step {
            opacity: 0.25;
            transition: opacity 0.3s ease-in-out;
            margin-bottom: 100vh; /* Space between steps */
            text-align: left;
            position: relative;
        }
        .step.is-active {
            opacity: 1;
            position: sticky;
            top: 0;
            margin-bottom: 0; /* Remove bottom margin when sticky */
        }
    </style>
</head>
<body>
    <div id="map-container"></div>
    <div class="content">
        <div class="header">Out My Window: New York City</div>
        <div class="subheader">Gail Albert Halaban</div>
        <div class="step" data-step="1">Step 1: Soho</div>
        <div class="step" data-step="2">Step 2: Nomad</div>
        <div class="step" data-step="3">Step 3: The Village</div>
        <div class="step" data-step="4">Step 4: Chinatown</div>
        <div class="step" data-step="5">Step 5: Chelsea</div>
        <div class="step" data-step="6">Step 6: Times Square</div>
    </div>

    <script src="https://unpkg.com/scrollama"></script>
    <script>
        // Initialize Scrollama
        const scroller = scrollama();

        // Variables to track zoom level
        let zoomLevel = 1;

        // Setup event handlers for Scrollama
        function handleStepEnter(response) {
            // Add is-active class to the current step
            response.element.classList.add('is-active');
            // Increase or decrease zoom level based on scroll direction
            zoomLevel += response.direction === 'down' ? 0.1 : -0.1;
            // Limit zoom level to a minimum of 1
            zoomLevel = Math.max(zoomLevel, 1);
            document.getElementById('map-container').style.transform = `scale(${zoomLevel})`;
        }

        function handleStepExit(response) {
            // Remove is-active class from the previous step
            response.element.classList.remove('is-active');
            // Reset zoom level and remove sticky positioning from the first step when scrolling up from the first step
            if (response.direction === 'up' && response.index === 0) {
                zoomLevel = 1;
                document.getElementById('map-container').style.transform = `scale(${zoomLevel})`;
                response.element.style.position = 'relative';
            }
        }

        // Setup the scroller instance
        scroller
            .setup({
                step: '.step',
                offset: 0.5,
                debug: false
            })
            .onStepEnter(handleStepEnter)
            .onStepExit(handleStepExit);

        // Resize listener to update Scrollama on window resize
        window.addEventListener('resize', scroller.resize);
    </script>
</body>
</html>
